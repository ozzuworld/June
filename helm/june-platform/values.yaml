# June Platform - Helm Values
# Complete configuration for all components

# Global Configuration
global:
  domain: ozzu.world
  environment: production

# Domain Configuration
domains:
  primary: ozzu.world
  api: api.ozzu.world
  idp: idp.ozzu.world
  stt: stt.ozzu.world
  tts: tts.ozzu.world
  turn: turn.ozzu.world
  livekit: livekit.ozzu.world

# Certificate Configuration
certificate:
  enabled: true
  issuer: letsencrypt-prod
  email: admin@ozzu.world  # CHANGE THIS
  secretName: ozzu-world-wildcard-tls
  useBackup: false  # Set to true when using backup certificates

# PostgreSQL Database
postgresql:
  enabled: true
  database: keycloak
  username: keycloak
  password: Pokemon123!  # CHANGE IN PRODUCTION
  storageClass: local-storage
  storage: 10Gi
  hostPath: /opt/june-postgresql-data

# Keycloak Identity Provider
keycloak:
  enabled: true
  adminUsername: admin
  adminPassword: Pokemon123!  # CHANGE IN PRODUCTION
  realm: june-realm

# LiveKit WebRTC Server - NOW ENABLED BY DEFAULT
livekit:
  enabled: true  # ✅ CHANGED: Enable LiveKit with Tailscale integration
  replicas: 1
  image:
    repository: livekit/livekit-server
    tag: latest
    pullPolicy: Always
  config:
    port: 7880
    rtc:
      tcp_port: 7881
      port_range_start: 50000
      port_range_end: 60000
      use_external_ip: true
      use_ice_lite: false
  resources:
    requests:
      memory: 512Mi
      cpu: 200m
    limits:
      memory: 1Gi
      cpu: 500m
  
# June Orchestrator Service
orchestrator:
  enabled: true
  replicas: 1
  image:
    repository: docker.io/ozzuworld/june-orchestrator
    tag: latest
    pullPolicy: Always
  resources:
    requests:
      memory: 512Mi
      cpu: 200m
    limits:
      memory: 1Gi
      cpu: 500m

# Speech-to-Text Service
stt:
  enabled: true
  replicas: 1
  image:
    repository: docker.io/ozzuworld/june-stt
    tag: latest
    pullPolicy: Always
  gpu:
    enabled: true
    count: 1
  resources:
    requests:
      memory: 6Gi
      cpu: "1"
    limits:
      memory: 6Gi
      cpu: "2"

# Text-to-Speech Service
tts:
  enabled: true
  replicas: 1
  image:
    repository: docker.io/ozzuworld/june-tts
    tag: latest
    pullPolicy: Always
  gpu:
    enabled: true
    count: 1
  resources:
    requests:
      memory: 4Gi
      cpu: "1"
    limits:
      memory: 6Gi
      cpu: "2"

# STUNner Configuration (for reference)
# Note: STUNner is now configured via k8s/stunner/ manifests
stunner:
  enabled: false  # Deployed via Phase 07-stunner
  username: june-user
  password: Pokemon123!

# Tailscale Sidecar Configuration - NOW ENABLED BY DEFAULT
# Adds Tailscale sidecars to services for private network access via Headscale
tailscale:
  enabled: true  # ✅ CHANGED: Enable Tailscale sidecars by default
  controlUrl: "https://headscale.ozzu.world"
  userspace: true  # Use userspace networking for better security
  image: "ghcr.io/tailscale/tailscale:latest"
  resources:
    requests:
      cpu: 50m
      memory: 128Mi
    limits:
      cpu: 200m
      memory: 256Mi
  # Secret key names for auth keys (created by deploy-headscale-sidecars.sh)
  authKeyRefs:
    orchestrator: "june-orchestrator-authkey"
    idp: "june-idp-authkey"
    stt: "june-stt-authkey"
    tts: "june-tts-authkey"
    livekit: "livekit-authkey"

# Secrets (Set via --set or separate values file)
secrets:
  geminiApiKey: ""  # REQUIRED: Set via --set secrets.geminiApiKey=xxx
  cloudflareToken: ""  # REQUIRED for cert-manager