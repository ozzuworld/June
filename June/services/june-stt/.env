# June STT Service Configuration - WhisperX Enhanced

# === Core Settings ===
PORT=8080
LOG_LEVEL=INFO

# === WhisperX Model Configuration ===
WHISPER_MODEL=large-v3-turbo
WHISPER_DEVICE=auto
WHISPER_COMPUTE_TYPE=float16
WHISPER_CACHE_DIR=/app/models

# === Performance Settings ===
WHISPER_NUM_WORKERS=1
WHISPER_CPU_THREADS=4
WHISPER_BEAM_SIZE=5

# === Batched Inference ===
USE_BATCHED_INFERENCE=true
BATCH_SIZE=8

# === WhisperX Enhanced Features ===
# Word-level timestamps (powered by phoneme-based alignment)
ENABLE_WORD_TIMESTAMPS=true

# Speaker diarization (requires HF_TOKEN)
DIARIZATION_ENABLED=false
MIN_SPEAKERS=1
MAX_SPEAKERS=5

# HuggingFace Token (required for diarization)
# Get yours at: https://huggingface.co/settings/tokens
HF_TOKEN=

# === Latino English Accent Optimization ===
WHISPER_LANGUAGE=en
DEFAULT_LANGUAGE=en
FORCE_LANGUAGE=true

# Specialized prompt for Latino accent + tech vocabulary
INITIAL_PROMPT="English speech with Latino accent. Technology terms: Kubernetes, Docker, API, microservices, Redis, database, configuration, orchestrator, deployment. Common words: can't, you can't, understand, explain, quantum, mechanics, particles, algorithm."

ACCENT_OPTIMIZATION=true

# === Natural Conversation Timing ===
MAX_UTTERANCE_SEC=8.0
MIN_UTTERANCE_SEC=0.4
SILENCE_TIMEOUT_SEC=1.2

# === Silero VAD (Preprocessing for WhisperX) ===
SILERO_VAD_ENABLED=true
SILERO_VAD_THRESHOLD=0.45
SILERO_MIN_SPEECH_MS=80
SILERO_MIN_SILENCE_MS=150

# Disable legacy VAD (WhisperX has built-in VAD)
VAD_ENABLED=false
STT_RMS_PREFILTER=false

# === SOTA Streaming with Word-Level Partials ===
SOTA_MODE_ENABLED=true
ULTRA_FAST_PARTIALS=true
AGGRESSIVE_VAD_TUNING=true
STT_STREAMING_ENABLED=true
STT_PARTIALS_ENABLED=true
STT_CONTINUOUS_PARTIALS=true

# WhisperX word-level partial streaming
WORD_LEVEL_PARTIALS=true
PARTIAL_EMIT_INTERVAL_MS=150
PARTIAL_MIN_SPEECH_MS=150

# === Transcription Quality ===
CONDITION_ON_PREVIOUS_TEXT=false
WHISPER_TEMPERATURE=0.0
WHISPER_BEAM_SIZE=5

# === File Processing ===
MAX_FILE_SIZE_MB=100

# === LiveKit Configuration ===
LIVEKIT_WS_URL=wss://livekit.ozzu.world
LIVEKIT_API_KEY=devkey
LIVEKIT_API_SECRET=secret
LIVEKIT_ENABLED=true

# === Orchestrator Integration ===
ORCHESTRATOR_URL=http://june-orchestrator.june-services.svc.cluster.local:8080
ORCHESTRATOR_API_KEY=
ORCHESTRATOR_ENABLED=true