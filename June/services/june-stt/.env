# June STT Service Configuration - Optimized for Latino English Accent & Natural Conversation

# === Core Settings ===
PORT=8080
LOG_LEVEL=INFO

# === SOTA Model Configuration - Upgraded for Latino accent accuracy ===
# large-v3-turbo = 809M params, much better for accented English
WHISPER_MODEL=large-v3-turbo
WHISPER_DEVICE=auto
WHISPER_COMPUTE_TYPE=float16
WHISPER_CACHE_DIR=/app/models

# === Performance Settings ===
WHISPER_NUM_WORKERS=1
WHISPER_CPU_THREADS=4
WHISPER_BEAM_SIZE=5

# === Batched Inference (Essential for large-v3-turbo) ===
STT_USE_BATCHED=true
STT_BATCH_SIZE=8
USE_BATCHED_INFERENCE=true
BATCH_SIZE=8

# === Latino English Accent Optimization ===
# Force English language to prevent false detection
WHISPER_LANGUAGE=en
DEFAULT_LANGUAGE=en
FORCE_LANGUAGE=true

# Specialized prompt for Latino accent + tech vocabulary
INITIAL_PROMPT="English speech with Latino accent. Technology terms: Kubernetes, Docker, API, microservices, Redis, database, configuration, orchestrator, deployment. Common words: can't, you can't, understand, explain, quantum, mechanics, particles, algorithm."

# Enable accent optimization
ACCENT_OPTIMIZATION=true

# === NATURAL CONVERSATION TIMING - Optimized for real-time chat ===
# Much more responsive timing for natural conversation
MAX_UTTERANCE_SEC=8.0      # Reduced from 15.0s - prevents overly long chunks
MIN_UTTERANCE_SEC=0.4      # Reduced from 1.0s - faster response to short phrases
SILENCE_TIMEOUT_SEC=1.2    # Reduced from 2.5s - much more responsive

# === Enhanced Silero VAD for Accented Speech ===
# More sensitive to catch Latino accent patterns
SILERO_VAD_ENABLED=true
SILERO_VAD_THRESHOLD=0.45   # Slightly lower for accented speech
SILERO_MIN_SPEECH_MS=80    # Faster speech detection
SILERO_MIN_SILENCE_MS=150  # More tolerant of accent pauses

# Disable legacy VAD
VAD_ENABLED=false
STT_RMS_PREFILTER=false

# === SOTA Streaming for Natural Flow ===
SOTA_MODE_ENABLED=true
ULTRA_FAST_PARTIALS=true
AGGRESSIVE_VAD_TUNING=true
STT_STREAMING_ENABLED=true
STT_PARTIALS_ENABLED=true
STT_CONTINUOUS_PARTIALS=true

# Faster partial delivery
PARTIAL_EMIT_INTERVAL_MS=150    # Faster partials
PARTIAL_MIN_SPEECH_MS=150       # Quick partial threshold

# === Transcription Quality for Accented Speech ===
CONDITION_ON_PREVIOUS_TEXT=false
WHISPER_TEMPERATURE=0.0         # Deterministic for consistency
WHISPER_BEAM_SIZE=5             # Good accuracy for accents

# === File Processing ===
MAX_FILE_SIZE_MB=100

# === LiveKit Configuration ===
LIVEKIT_WS_URL=wss://livekit.ozzu.world
LIVEKIT_API_KEY=devkey
LIVEKIT_API_SECRET=secret
LIVEKIT_ENABLED=true

# === Orchestrator Integration ===
ORCHESTRATOR_URL=http://june-orchestrator.june-services.svc.cluster.local:8080
ORCHESTRATOR_API_KEY=
ORCHESTRATOR_ENABLED=true