env:
# Database Configuration
- name: KC_DB
  value: postgres
- name: KC_DB_URL
  value: jdbc:postgresql://postgresql.june-services.svc.cluster.local:5432/keycloak
- name: KC_DB_USERNAME
  value: keycloak
- name: KC_DB_PASSWORD
  value: Pokemon123!

# Admin Configuration  
- name: KC_BOOTSTRAP_ADMIN_USERNAME
  value: admin
- name: KC_BOOTSTRAP_ADMIN_PASSWORD
  value: Pokemon123!

# HTTP Configuration
- name: KC_HTTP_ENABLED
  value: "true"
- name: KC_HTTP_PORT
  value: "8080"

# ðŸ”¥ FIX: Proper hostname and proxy configuration
- name: KC_HOSTNAME
  value: "idp.allsafe.world"
- name: KC_HOSTNAME_STRICT
  value: "true"  # Changed to true
- name: KC_HOSTNAME_STRICT_HTTPS
  value: "false"  # Keep false since ingress handles HTTPS
- name: KC_HOSTNAME_BACKCHANNEL_DYNAMIC
  value: "true"  # Allow dynamic backchannel URLs

# ðŸ”¥ FIX: Critical proxy settings for ingress
- name: KC_PROXY
  value: "edge"  # Changed back to edge - correct for reverse proxy
- name: KC_HTTP_RELATIVE_PATH
  value: "/"

# Health and metrics
- name: KC_HEALTH_ENABLED
  value: "true"
- name: KC_METRICS_ENABLED
  value: "true"

# Logging
- name: KC_LOG_LEVEL
  value: "INFO"
- name: KC_LOG_CONSOLE_OUTPUT
  value: "default"