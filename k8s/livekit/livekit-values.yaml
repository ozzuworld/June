# LiveKit Server Configuration - USING ONLY STUNNER (NO GOOGLE!)
server:
  replicas: 1
  config:
    port: 7880
    rtc:
      udp_port: 7882
      tcp_port: 7881
      port_range_start: 50000
      port_range_end: 60000
      use_external_ip: true
      # CRITICAL: Set external IP explicitly
      external_ip: "34.59.178.219"
      # ONLY USE YOUR STUNNER - NO GOOGLE STUN!
      ice_servers:
        - urls: 
          - "stun:turn.ozzu.world:3478"  # ONLY your STUNner server
        - urls:
          - "turn:turn.ozzu.world:3478"
          username: "june-user"
          credential: "Pokemon123!"
      # Force use of only configured STUN/TURN servers
      stun_servers:
        - "turn.ozzu.world:3478"  # Only STUNner, no Google fallback
    # DISABLE embedded TURN - use STUNner only
    turn:
      enabled: false
    # CRITICAL: WebRTC signaling configuration
    keys:
      devkey: bbUEBtMjPHrvdZwFEwcpPDJkePL5yTrJ
    # Logging configuration
    logging:
      level: debug  # Temporary for troubleshooting
      json: true
    # Development settings for WebSocket handling
    development: false

# API Keys - CRITICAL: Replace with your actual keys
livekit:
  keys:
    # Replace with your actual API key and secret
    devkey: bbUEBtMjPHrvdZwFEwcpPDJkePL5yTrJ
    # Add more key-value pairs as needed
    # ${LIVEKIT_API_KEY}: ${LIVEKIT_API_SECRET}

# Service Configuration - Simplified for STUNner only
service:
  type: ClusterIP
  ports:
    - name: http
      port: 80
      targetPort: 7880
      protocol: TCP
    - name: ice-tcp
      port: 7881
      targetPort: 7881
      protocol: TCP
    - name: ice-udp
      port: 7882
      targetPort: 7882
      protocol: UDP

# Simplified UDP service - STUNner handles TURN
udpService:
  enabled: true
  type: LoadBalancer
  ports:
    - name: ice-udp
      port: 7882
      targetPort: 7882
      protocol: UDP
  # Port range for WebRTC media (requires LoadBalancer or NodePort)
  portRange:
    start: 50000
    end: 50020  # Reduced range for K8s compatibility